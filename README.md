# FleetLoom

FleetLoom is a Golang-based API for managing user data with PostgreSQL as the database. It supports operations like creating, retrieving, updating, and deleting user records. The API is documented with Swagger, making it easy to explore and test the endpoints.

## Table of Contents

- [Project Structure](#project-structure)
- [Setup](#setup)
- [Running the Application](#running-the-application)
- [Using the API](#using-the-api)
- [Swagger Documentation](#swagger-documentation)
- [Code Explanation](#code-explanation)
- [Conclusion](#conclusion)

## Project Structure

The project is organized as follows:

```
FleetLoom/
├── controllers/
│   └── user_controller.go  # Contains the HTTP handler functions for the user-related endpoints
├── database/
│   └── db.go               # Handles the database connection setup
├── models/
│   └── user.go             # Defines the User model struct
├── routes/
│   └── routes.go           # Registers the API routes with the router
├── docs/                   # Contains the Swagger documentation (auto-generated by swag init)
├── go.mod                  # Go module file
├── go.sum                  # Go dependencies file
├── main.go                 # Entry point of the application
└── README.md               # This file
```

### Key Components:

- **`controllers/`**: Contains the logic for handling HTTP requests related to users.
- **`database/`**: Manages the database connection to PostgreSQL.
- **`models/`**: Defines the structure of the data (e.g., the `User` model).
- **`routes/`**: Maps API endpoints to their corresponding handler functions.
- **`docs/`**: Contains the Swagger documentation generated by the `swag` tool.
- **`main.go`**: Initializes the database, sets up the routes, and starts the server.

## Setup

### Prerequisites

- Go 1.16 or higher
- PostgreSQL
- Docker (optional, for running PostgreSQL in a container)
- Swag CLI for generating Swagger docs

### Step 1: Install Go

If you haven't installed Go yet, download and install it from [here](https://golang.org/dl/).

### Step 2: Install PostgreSQL

You can either install PostgreSQL on your local machine or run it in a Docker container.

#### Running PostgreSQL in Docker:

```bash
docker run --name postgres_container -e POSTGRES_PASSWORD=yourpassword -e POSTGRES_DB=fleetloom_db -p 5432:5432 -d postgres:latest
```

### Step 3: Clone the Repository

Clone this repository to your local machine:

```bash
git clone https://github.com/yourusername/FleetLoom.git
cd FleetLoom
```

### Step 4: Install Dependencies

Install the required Go packages:

```bash
go mod tidy
#go get -u github.com/swaggo/swag/cmd/swag
go install github.com/swaggo/swag/cmd/swag@latest
go get -u github.com/swaggo/gin-swagger
go get -u github.com/swaggo/gin-swagger/swaggerFiles

```

### Step 5: Generate Swagger Documentation

Generate the Swagger documentation:

```bash
swag init
```

### Step 6: Configure the Database Connection

In `main.go`, update the `connectionString` variable with your PostgreSQL credentials:

```go
connectionString := "host=localhost user=postgres password=yourpassword dbname=fleetloom_db port=5432 sslmode=disable TimeZone=Asia/Kolkata"
```

## Running the Application

Start the server by running:

```bash
go run main.go
```

The server will start on `http://localhost:8080`.

## Using the API

### Create a User

- **Endpoint**: `POST /users`
- **Description**: Creates a new user.
- **Request Body**: JSON with user details.

**Example:**

```bash
curl -X POST http://localhost:8080/users -H "Content-Type: application/json" -d '{
  "first_name": "John",
  "last_name": "Doe",
  "current_address": "123 Main St",
  "permanent_address": "123 Main St",
  "pincode": "123456",
  "city": "Pune",
  "state": "Maharashtra",
  "contact_number": "+911234567899",
  "email": "john.doe@example.com",
  "password": "password123",
  "emergency_first_name": "Jane",
  "emergency_last_name": "Doe",
  "aadhar_card_number": "123412341234",
  "driving_license_number": "AA-12-1234-1234567",
  "pan_card_number": "ABCDE1234F",
  "branch": "Mumbai"
}'
```

### Get a User

- **Endpoint**: `GET /users/{id}`
- **Description**: Retrieves a user by their ID.

**Example:**

```bash
curl -X GET http://localhost:8080/users/1
```

### Update a User

- **Endpoint**: `PUT /users/{id}`
- **Description**: Updates a user's details by their ID.
- **Request Body**: JSON with updated user details.

**Example:**

```bash
curl -X PUT http://localhost:8080/users/1 -H "Content-Type: application/json" -d '{
  "first_name": "John",
  "last_name": "Doe",
  "current_address": "456 Another St",
  "permanent_address": "456 Another St",
  "pincode": "654321",
  "city": "Mumbai",
  "state": "Maharashtra",
  "contact_number": "+919876543210",
  "email": "john.doe@example.com",
  "password": "newpassword123",
  "emergency_first_name": "Jane",
  "emergency_last_name": "Doe",
  "aadhar_card_number": "123412341234",
  "driving_license_number": "AA-12-1234-1234567",
  "pan_card_number": "ABCDE1234F",
  "branch": "Mumbai"
}'
```

### Delete a User

- **Endpoint**: `DELETE /users/{id}`
- **Description**: Deletes a user by their ID.

**Example:**

```bash
curl -X DELETE http://localhost:8080/users/1
```

## Swagger Documentation

Once the server is running, you can access the Swagger UI to interact with the API:

```plaintext
http://localhost:8080/swagger/index.html
```

The Swagger UI allows you to test all the API endpoints, see the expected request/response formats, and understand the functionality of the API.

## Code Explanation

### `main.go`

- **Purpose**: The entry point of the application.
- **Key Functions**:
  - Initializes the database connection.
  - Sets up the router and registers routes.
  - Starts the HTTP server.

### `database/db.go`

- **Purpose**: Handles the connection to the PostgreSQL database.
- **Key Functions**:
  - `InitDB`: Establishes a connection to the database using the connection string.

### `models/user.go`

- **Purpose**: Defines the structure of the `User` model, which represents a user in the system.
- **Key Fields**:
  - `ID`: Unique identifier for the user.
  - `FirstName`, `LastName`: User's name fields.
  - `ContactNumber`, `Email`, etc.: Other personal details.

### `controllers/user_controller.go`

- **Purpose**: Contains the handler functions for user-related operations.
- **Key Functions**:
  - `CreateUser`: Handles creating a new user.
  - `GetUser`: Handles retrieving a user by ID.
  - `UpdateUser`: Handles updating a user's details.
  - `DeleteUser`: Handles deleting a user.

### `routes/routes.go`

- **Purpose**: Registers the API routes with the router.
- **Key Functions**:
  - `RegisterUserRoutes`: Maps API endpoints to their corresponding handler functions in `user_controller.go`.

### `docs/`

- **Purpose**: Contains the Swagger documentation generated by `swag init`.
- **Key Files**:
  - `swagger.json`, `swagger.yaml`: Define the API's structure and documentation.

## Conclusion

This project provides a simple yet powerful API for managing user data using Go and PostgreSQL. By following the setup instructions and understanding the code structure, you should be able to extend this project to fit your needs or integrate it with other systems.

Personal changes -------

I have pgadmin installed on my system. In it user ->postgres && password ->rohan

Created a table with name users in database fleetloom_db
```
CREATE TABLE users (
    id SERIAL PRIMARY KEY,  -- Unique identifier for the user (Primary Key)
    first_name VARCHAR(255) NOT NULL,  -- User's first name
    last_name VARCHAR(255) NOT NULL,  -- User's last name
    current_address TEXT NOT NULL,  -- User's current address
    permanent_address TEXT NOT NULL,  -- User's permanent address
    pincode VARCHAR(10) NOT NULL,  -- Pincode for the user's address
    city VARCHAR(100) NOT NULL,  -- City where the user resides
    state VARCHAR(100) NOT NULL,  -- State where the user resides
    contact_number VARCHAR(15) NOT NULL,  -- User's contact number
    email VARCHAR(255) UNIQUE NOT NULL,  -- User's email address
    password VARCHAR(255) NOT NULL,  -- User's password (should be hashed in a real application)
    emergency_first_name VARCHAR(255) NOT NULL,  -- First name of the user's emergency contact
    emergency_last_name VARCHAR(255) NOT NULL,  -- Last name of the user's emergency contact
    aadhar_card_number VARCHAR(12) UNIQUE NOT NULL,  -- User's Aadhar card number (Indian ID)
    driving_license_number VARCHAR(20) UNIQUE NOT NULL,  -- User's driving license number
    pan_card_number VARCHAR(10) UNIQUE NOT NULL,  -- User's PAN card number (Indian tax ID)
    branch VARCHAR(100) NOT NULL,  -- The branch where the user is associated
    created_at TIMESTAMPTZ DEFAULT NOW()  -- Timestamp when the user was created
);
```